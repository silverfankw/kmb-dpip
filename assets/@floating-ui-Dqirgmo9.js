const P=Math.min,U=Math.max,O=Math.round,x=Math.floor,F=t=>({x:t,y:t});function j(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function C(){return typeof window<"u"}function V(t){return _(t)?(t.nodeName||"").toLowerCase():"#document"}function g(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function H(t){var e;return(e=(_(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function _(t){return C()?t instanceof Node||t instanceof g(t).Node:!1}function k(t){return C()?t instanceof Element||t instanceof g(t).Element:!1}function N(t){return C()?t instanceof HTMLElement||t instanceof g(t).HTMLElement:!1}function A(t){return!C()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof g(t).ShadowRoot}function I(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=M(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(o)}function K(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function X(t){return["html","body","#document"].includes(V(t))}function M(t){return g(t).getComputedStyle(t)}function Y(t){if(V(t)==="html")return t;const e=t.assignedSlot||t.parentNode||A(t)&&t.host||H(t);return A(e)?e.host:e}function $(t){const e=Y(t);return X(e)?t.ownerDocument?t.ownerDocument.body:t.body:N(e)&&I(e)?e:$(e)}function S(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=$(t),c=o===((r=t.ownerDocument)==null?void 0:r.body),i=g(o);if(c){const s=L(i);return e.concat(i,i.visualViewport||[],I(o)?o:[],s&&n?S(s):[])}return e.concat(o,S(o,[],n))}function L(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function G(t){const e=M(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=N(t),c=o?t.offsetWidth:n,i=o?t.offsetHeight:r,s=O(n)!==c||O(r)!==i;return s&&(n=c,r=i),{width:n,height:r,$:s}}function T(t){return k(t)?t:t.contextElement}function B(t){const e=T(t);if(!N(e))return F(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:c}=G(e);let i=(c?O(n.width):n.width)/r,s=(c?O(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const J=F(0);function Q(t){const e=g(t);return!K()||!e.visualViewport?J:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Z(t,e,n){return!1}function W(t,e,n,r){e===void 0&&(e=!1);const o=t.getBoundingClientRect(),c=T(t);let i=F(1);e&&(i=B(t));const s=Z()?Q(c):F(0);let a=(o.left+s.x)/i.x,u=(o.top+s.y)/i.y,p=o.width/i.x,v=o.height/i.y;if(c){const y=g(c),d=r;let m=y,l=L(m);for(;l&&r&&d!==m;){const h=B(l),f=l.getBoundingClientRect(),w=M(l),b=f.left+(l.clientLeft+parseFloat(w.paddingLeft))*h.x,E=f.top+(l.clientTop+parseFloat(w.paddingTop))*h.y;a*=h.x,u*=h.y,p*=h.x,v*=h.y,a+=b,u+=E,m=g(l),l=L(m)}}return j({width:p,height:v,x:a,y:u})}function q(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function tt(t,e){let n=null,r;const o=H(t);function c(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,a){s===void 0&&(s=!1),a===void 0&&(a=1),c();const u=t.getBoundingClientRect(),{left:p,top:v,width:y,height:d}=u;if(s||e(),!y||!d)return;const m=x(v),l=x(o.clientWidth-(p+y)),h=x(o.clientHeight-(v+d)),f=x(p),b={rootMargin:-m+"px "+-l+"px "+-h+"px "+-f+"px",threshold:U(0,P(1,a))||1};let E=!0;function D(z){const R=z[0].intersectionRatio;if(R!==a){if(!E)return i();R?i(!1,R):r=setTimeout(()=>{i(!1,1e-7)},1e3)}R===1&&!q(u,t.getBoundingClientRect())&&i(),E=!1}try{n=new IntersectionObserver(D,{...b,root:o.ownerDocument})}catch{n=new IntersectionObserver(D,b)}n.observe(t)}return i(!0),c}function et(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:c=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:a=!1}=r,u=T(t),p=o||c?[...u?S(u):[],...S(e)]:[];p.forEach(f=>{o&&f.addEventListener("scroll",n,{passive:!0}),c&&f.addEventListener("resize",n)});const v=u&&s?tt(u,n):null;let y=-1,d=null;i&&(d=new ResizeObserver(f=>{let[w]=f;w&&w.target===u&&d&&(d.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var b;(b=d)==null||b.observe(e)})),n()}),u&&!a&&d.observe(u),d.observe(e));let m,l=a?W(t):null;a&&h();function h(){const f=W(t);l&&!q(l,f)&&n(),l=f,m=requestAnimationFrame(h)}return n(),()=>{var f;p.forEach(w=>{o&&w.removeEventListener("scroll",n),c&&w.removeEventListener("resize",n)}),v==null||v(),(f=d)==null||f.disconnect(),d=null,a&&cancelAnimationFrame(m)}}export{et as a};
